//Using Ropsten testnet
var contractAddress = "0xEed425a987E689B682B3C8d22F262a5d684bF4eB";
//Se poss√≠vel colocar contractAbi num arquivo externo
var contractAbi = [ { "constant": true, "inputs": [], "name": "name", "outputs": [ { "name": "", "type": "string", "value": "Crowdsale Alfa v9.1" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "deadline", "outputs": [ { "name": "", "type": "uint256", "value": "1508645534" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "beneficiary", "outputs": [ { "name": "", "type": "address", "value": "0xb69237d012c2f911382877a7eab7851f8037bf9b" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "tokenHolder", "outputs": [ { "name": "", "type": "address", "value": "0xb69237d012c2f911382877a7eab7851f8037bf9b" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "discount", "outputs": [ { "name": "currentDiscount", "type": "uint256", "value": "0" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "tokenReward", "outputs": [ { "name": "", "type": "address", "value": "0x154357425f38cd8879de9a59c815c0ff3d3a7a5e" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": false, "inputs": [], "name": "Withdrawal", "outputs": [ { "name": "sucess", "type": "bool" } ], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": true, "inputs": [], "name": "amountRaised", "outputs": [ { "name": "", "type": "uint256", "value": "5921822000000000000" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "tokensIssued", "outputs": [ { "name": "", "type": "uint256", "value": "52106" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": false, "inputs": [], "name": "enablePurchase", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": true, "inputs": [], "name": "owner", "outputs": [ { "name": "", "type": "address", "value": "0xb69237d012c2f911382877a7eab7851f8037bf9b" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "currentPrice", "outputs": [ { "name": "currentPriceOfEachToken", "type": "uint256", "value": "1000000000000000" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "reclaimEtherDeadline", "outputs": [ { "name": "deadlineToReclaimEtherIfFailSafeIsActivated", "type": "uint256", "value": "1508645834" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": false, "inputs": [], "name": "disablePurchase", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "constant": true, "inputs": [], "name": "remainingTokens", "outputs": [ { "name": "tokensStillOnSale", "type": "uint256", "value": "948448" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "purchasingAllowed", "outputs": [ { "name": "", "type": "bool", "value": true } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "_owner", "type": "address" } ], "name": "etherContributionOf", "outputs": [ { "name": "amountContributedAtTheCrowdsaleInWei", "type": "uint256", "value": "0" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "crowdsaleStartTime", "outputs": [ { "name": "", "type": "uint256", "value": "1508643734" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [ { "name": "_owner", "type": "address" } ], "name": "tokenBalanceOf", "outputs": [ { "name": "tokensBoughtAtCrowdsale", "type": "uint256", "value": "0" } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "crowdsaleState", "outputs": [ { "name": "isCrowdsaleStarted", "type": "bool", "value": true } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": true, "inputs": [], "name": "failSafeMode", "outputs": [ { "name": "", "type": "bool", "value": true } ], "payable": false, "stateMutability": "view", "type": "function" }, { "constant": false, "inputs": [ { "name": "newOwner", "type": "address" } ], "name": "transferOwnership", "outputs": [], "payable": false, "stateMutability": "nonpayable", "type": "function" }, { "inputs": [ { "name": "contractName", "type": "string", "index": 0, "typeShort": "string", "bits": "", "displayName": "contract Name", "template": "elements_input_string", "value": "Crowdsale Alfa v9.1" }, { "name": "ifSuccessfulSendTo", "type": "address", "index": 1, "typeShort": "address", "bits": "", "displayName": "if Successful Send To", "template": "elements_input_address", "value": "0xb69237d012c2f911382877a7EAB7851f8037bf9B" }, { "name": "durationInMinutes", "type": "uint256", "index": 2, "typeShort": "uint", "bits": "256", "displayName": "duration In Minutes", "template": "elements_input_uint", "value": "30" }, { "name": "howManyTokensAnEtherCanBuy", "type": "uint256", "index": 3, "typeShort": "uint", "bits": "256", "displayName": "how Many Tokens An Ether Can Buy", "template": "elements_input_uint", "value": "1000" }, { "name": "addressOfTokenUsedAsReward", "type": "address", "index": 4, "typeShort": "address", "bits": "", "displayName": "address Of Token Used As Reward", "template": "elements_input_address", "value": "0x154357425f38cd8879de9a59c815c0Ff3d3A7A5e" }, { "name": "adressOfTokenHolder", "type": "address", "index": 5, "typeShort": "address", "bits": "", "displayName": "adress Of Token Holder", "template": "elements_input_address", "value": "0xb69237d012c2f911382877a7EAB7851f8037bf9B" }, { "name": "crowdsaleCooldownInMinutes", "type": "uint256", "index": 6, "typeShort": "uint", "bits": "256", "displayName": "crowdsale Cooldown In Minutes", "template": "elements_input_uint", "value": "8" }, { "name": "ifInFailSafeTimeInMinutesAfterDeadlineToReclaimForgottenEther", "type": "uint256", "index": 7, "typeShort": "uint", "bits": "256", "displayName": "if In Fail Safe Time In Minutes After Deadline To Reclaim Forgotten Ether", "template": "elements_input_uint", "value": "5" } ], "payable": false, "stateMutability": "nonpayable", "type": "constructor" }, { "payable": true, "stateMutability": "payable", "type": "fallback" }, { "anonymous": false, "inputs": [ { "indexed": true, "name": "taker", "type": "address" }, { "indexed": false, "name": "amount", "type": "uint256" }, { "indexed": false, "name": "tokensBought", "type": "uint256" } ], "name": "TokenPurchase", "type": "event" }, { "anonymous": false, "inputs": [ { "indexed": true, "name": "to", "type": "address" }, { "indexed": false, "name": "amount", "type": "uint256" }, { "indexed": false, "name": "isBeneficiary", "type": "bool" } ], "name": "FundWithdrawal", "type": "event" }, { "anonymous": false, "inputs": [ { "indexed": false, "name": "enabled", "type": "bool" } ], "name": "purchasingAllowed", "type": "event" }, { "anonymous": false, "inputs": [ { "indexed": false, "name": "reason", "type": "string" } ], "name": "ExecutionError", "type": "event" }, { "anonymous": false, "inputs": [ { "indexed": false, "name": "", "type": "bool" } ], "name": "FailSafeActivaded", "type": "event" }, { "anonymous": false, "inputs": [ { "indexed": true, "name": "_owner", "type": "address" }, { "indexed": true, "name": "_newOwner", "type": "address" } ], "name": "TransferOwnership", "type": "event" } ]
var contractInstance;

window.addEventListener('load', function () {
	if (typeof web3 !== 'undefined') {
		console.log('Web3 Detected! ' + web3.currentProvider.constructor.name)
		window.web3 = new Web3(web3.currentProvider);
		//web3 = new Web3(web3.currentProvider);
	} else {
		console.log('No Web3 Detected... using HTTP Provider')
		window.web3 = new Web3(new Web3.providers.HttpProvider("https://ropsten.infura.io/YMToken"));
		//web3 = new Web3(new Web3.providers.HttpProvider("https://ropstend.infura.io/YMToken"));
	}
	contractInstance = web3.eth.contract(contractAbi).at(contractAddress);
	
	setTimeout(update,1000);
})
async function update() {
	var contractInstance = web3.eth.contract(contractAbi).at(contractAddress);
	
	$("#remain").attr("data-value",contractInstance.remainingTokens());
	$("#ether").attr("data-value",web3.fromWei(contractInstance.amountRaised()*1000000000000000000, 'ether'));
	$("#dolar").attr("data-value",web3.fromWei(contractInstance.amountRaised()*441.81, 'ether'));//11-12-2017 00:116
	$("#discount").attr("data-value",contractInstance.discount());
	setTimeout(update,60000);
}

